<!DOCTYPE html>
<html lang=EN>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Flare on writeup 2017 writeup">
<meta property="og:type" content="article">
<meta property="og:title" content="Flare on writeup 2017 writeup">
<meta property="og:url" content="https://bestwing.me/2017-flare-on-write-up.html">
<meta property="og:site_name" content="Swing&#39;Blog 浮生若梦">
<meta property="og:description" content="Flare on writeup 2017 writeup">
<meta property="og:locale">
<meta property="article:published_time" content="2017-10-14T16:00:00.000Z">
<meta property="article:modified_time" content="2019-10-28T13:27:52.000Z">
<meta property="article:author" content="Swing">
<meta property="article:tag" content="reverse">
<meta property="article:tag" content="Flare on">
<meta name="twitter:card" content="summary">
    
    
      
        
          <link rel="shortcut icon" href="/images/favicon.ico">
        
      
      
        
          <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
        
      
    
    <!-- title -->
    <title>Flare on writeup 2017 writeup</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Swing&#39;Blog 浮生若梦" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 5.4.2"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/link">Links</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/ropemporium-all-writeup.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2017-Kaspersky-Industrial-CTF-Quals-Backdoor-Pi.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bestwing.me/2017-flare-on-write-up.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bestwing.me/2017-flare-on-write-up.html&text=Flare on writeup 2017 writeup"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bestwing.me/2017-flare-on-write-up.html&is_video=false&description=Flare on writeup 2017 writeup"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Flare on writeup 2017 writeup&body=Check out this article: https://bestwing.me/2017-flare-on-write-up.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bestwing.me/2017-flare-on-write-up.html&name=Flare on writeup 2017 writeup&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://bestwing.me/2017-flare-on-write-up.html&t=Flare on writeup 2017 writeup"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ROT13"><span class="toc-number">1.</span> <span class="toc-text">ROT13</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E9%9D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">题面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">1.2.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Igniteme"><span class="toc-number">2.</span> <span class="toc-text">Igniteme</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-1"><span class="toc-number">2.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Greektome"><span class="toc-number">3.</span> <span class="toc-text">Greektome</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">3.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notepad"><span class="toc-number">4.</span> <span class="toc-text">Notepad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pewpewboat"><span class="toc-number">5.</span> <span class="toc-text">Pewpewboat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-3"><span class="toc-number">5.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Payload"><span class="toc-number">6.</span> <span class="toc-text">Payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%81%E7%84%B6%E5%8F%91%E7%8E%B0%E5%9B%BD%E5%86%85%E6%9C%89%E6%9C%89%E4%BA%BA%E5%86%99%E7%9A%84%E6%8C%BA%E5%AE%8C%E6%95%B4%E7%9A%84-%E6%88%91%E5%B0%B1%E4%B8%8D%E7%BB%A7%E7%BB%AD%E5%BE%80%E4%B8%8B%E5%86%99%E4%BA%86"><span class="toc-number">7.</span> <span class="toc-text">突然发现国内有有人写的挺完整的 我就不继续往下写了</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Flare on writeup 2017 writeup
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Swing</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2017-10-14T16:00:00.000Z" itemprop="datePublished">2017-10-15</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Writeup/">Writeup</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Flare-on/" rel="tag">Flare on</a>, <a class="tag-link-link" href="/tags/reverse/" rel="tag">reverse</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"<p>Flareon是主要题目为逆向的一场CTF比赛，已经是第四届了，比赛时间一个月左右。<br>这是第一次参加这个比赛，今年没拿到牌子，明年再战！</p>
<div align=center>
https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/2017-flare-on-result.jpg
</div>



<h2 id="ROT13"><a href="#ROT13" class="headerlink" title="ROT13"></a>ROT13</h2><h3 id="题面"><a href="#题面" class="headerlink" title="题面"></a>题面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">Html</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">title</span>&gt;</span>FLARE On 2017<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">name</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">id</span>=<span class="string">&quot;flag&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Enter the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;button&quot;</span> <span class="attr">id</span>=<span class="string">&quot;prompt&quot;</span> <span class="attr">value</span>=<span class="string">&quot;Click to check the flag&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span></span><br><span class="line"><span class="javascript">            <span class="built_in">document</span>.getElementById(<span class="string">&quot;prompt&quot;</span>).onclick = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> flag = <span class="built_in">document</span>.getElementById(<span class="string">&quot;flag&quot;</span>).value;</span></span><br><span class="line"><span class="javascript">                <span class="keyword">var</span> rotFlag = flag.replace(<span class="regexp">/[a-zA-Z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">c</span>)</span>&#123;<span class="keyword">return</span> <span class="built_in">String</span>.fromCharCode((c &lt;= <span class="string">&quot;Z&quot;</span> ? <span class="number">90</span> : <span class="number">122</span>) &gt;= (c = c.charCodeAt(<span class="number">0</span>) + <span class="number">13</span>) ? c : c - <span class="number">26</span>);&#125;);</span></span><br><span class="line"><span class="javascript">                <span class="keyword">if</span> (<span class="string">&quot;PyvragFvqrYbtvafNerRnfl@syner-ba.pbz&quot;</span> == rotFlag) &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Correct flag!&quot;</span>);</span></span><br><span class="line"><span class="javascript">                &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="javascript">                    alert(<span class="string">&quot;Incorrect flag, rot again&quot;</span>);</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="解题"><a href="#解题" class="headerlink" title="解题"></a>解题</h3><p>解rot13即可</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> rot13=<span class="string">&quot;tr &#x27;[A-Za-z]&#x27; &#x27;[N-ZA-Mn-za-m]&#x27;&quot;</span></span><br><span class="line"><span class="built_in">echo</span> PyvragFvqrYbtvafNerRnfl@syner-ba.pbz | rot13</span><br></pre></td></tr></table></figure>
<p>flag： <code>ClientSideLoginsAreEasy@flare-on.com</code></p>
<h2 id="Igniteme"><a href="#Igniteme" class="headerlink" title="Igniteme"></a>Igniteme</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">signed</span> <span class="keyword">int</span> <span class="title">check</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="keyword">int</span> len; <span class="comment">// ST04_4</span></span><br><span class="line">  <span class="keyword">int</span> i; <span class="comment">// [esp+4h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">unsigned</span> <span class="keyword">int</span> ia; <span class="comment">// [esp+4h] [ebp-8h]</span></span><br><span class="line">  <span class="keyword">char</span> key; <span class="comment">// [esp+Bh] [ebp-1h]</span></span><br><span class="line"></span><br><span class="line">  len = <span class="built_in">strlen</span>((<span class="keyword">int</span>)input_cpy);</span><br><span class="line">  key = getkey();</span><br><span class="line">  <span class="keyword">for</span> ( i = len - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i )</span><br><span class="line">  &#123;</span><br><span class="line">    cmpprep[i] = key ^ input_cpy[i];</span><br><span class="line">    key = input_cpy[i];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">for</span> ( ia = <span class="number">0</span>; ia &lt; <span class="number">0x27</span>; ++ia )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( cmpprep[ia] != (<span class="keyword">unsigned</span> __int8)cmptable[ia] )</span><br><span class="line">      <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>程序启动后输入字符串XOR然后做对比。</p>
<h3 id="解题-1"><a href="#解题-1" class="headerlink" title="解题"></a>解题</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vp = [<span class="number">0x0D</span>, <span class="number">0x26</span>, <span class="number">0x49</span>, <span class="number">0x45</span>, <span class="number">0x2A</span>, <span class="number">0x17</span>, <span class="number">0x78</span>, <span class="number">0x44</span>, <span class="number">0x2B</span>, <span class="number">0x6C</span>, <span class="number">0x5D</span>, <span class="number">0x5E</span>, <span class="number">0x45</span>, <span class="number">0x12</span>, <span class="number">0x2F</span>, <span class="number">0x17</span>, <span class="number">0x2B</span>, <span class="number">0x44</span>, <span class="number">0x6F</span>, <span class="number">0x6E</span>, <span class="number">0x56</span>, <span class="number">0x09</span>, <span class="number">0x5F</span>, <span class="number">0x45</span>, <span class="number">0x47</span>, <span class="number">0x73</span>, <span class="number">0x26</span>, <span class="number">0x0A</span>, <span class="number">0x0D</span>, <span class="number">0x13</span>, <span class="number">0x17</span>, <span class="number">0x48</span>, <span class="number">0x42</span>, <span class="number">0x01</span>, <span class="number">0x40</span>, <span class="number">0x4D</span>, <span class="number">0x0C</span>, <span class="number">0x02</span>, <span class="number">0x69</span>, <span class="number">0x04</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(vp)-<span class="number">2</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">  vp[i] = vp[i] ^ vp[i+<span class="number">1</span>]</span><br><span class="line">vp = <span class="string">&#x27;&#x27;</span>.join([ <span class="built_in">chr</span>(i) <span class="keyword">for</span> i <span class="keyword">in</span> vp[:-<span class="number">1</span>]])</span><br><span class="line"><span class="comment"># R_y0u_H0t_3n0ugH_t0_1gn1t3@flare-on.com</span></span><br></pre></td></tr></table></figure>
<h2 id="Greektome"><a href="#Greektome" class="headerlink" title="Greektome"></a>Greektome</h2><div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-greektome-01.jpg)
</div>


<p>这是一个使用套接字从另一台机器接收数据的程序。看看代码我们可以看到IP地址=’127.0.0.1’和端口= 0x8AE = 2222的程序是开放的。Buf 接收4个字节=&gt; len（data_send）&lt;= 4</p>
<p>收到数据后，程序使用loc_40107c []数组中的元素将Buf [0]替换为xor， 并添加22h  ，然后将其保存到数组。</p>
<div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-greektome-02.jpg)
</div>




<p>实质上<br>输入被分成多组，每组20个字符，密钥验证算法如下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># # Key judgement</span><br><span class="line"># for &amp;bytes in 0x40107c -&gt; 0x40107c+0x79:</span><br><span class="line">#     bytes ^&#x3D; key</span><br><span class="line">#     bytes +&#x3D; 0x22</span><br><span class="line"># assert( 0xFB5E &#x3D;&#x3D; sub_4011E6(0x40107C, 0x79) )</span><br><span class="line"></span><br><span class="line"># # sub_4011E6(x,y)</span><br><span class="line"># assert( y !&#x3D; 0)</span><br><span class="line"># ebx &#x3D; x</span><br><span class="line"># eax &#x3D; 0x14</span><br><span class="line"># &#123;</span><br><span class="line">#     di &#x3D; (int16)var_4</span><br><span class="line">#     esi &#x3D; min(eax, edx)</span><br><span class="line">#     edx -&#x3D; esi</span><br><span class="line">#     &#123;</span><br><span class="line">#         eax &#x3D; </span><br><span class="line">#     &#125;</span><br><span class="line"># &#125;</span><br><span class="line"># &#x2F;&#x2F; CMOVx: Conditional move according to X</span><br><span class="line"># v2: 0x79 -&gt; 0x65 -&gt; 0x51 -&gt; 0x3D -&gt; 0x29 -&gt; 0x15 -&gt; 0x01 -&gt; 0</span><br></pre></td></tr></table></figure>
<h3 id="解题-2"><a href="#解题-2" class="headerlink" title="解题"></a>解题</h3><p>爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">generator</span>(<span class="params">a1,a2</span>):</span></span><br><span class="line">    v2 = a2</span><br><span class="line">    v3 = <span class="number">0xff</span></span><br><span class="line">    v8 = <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> a2:</span><br><span class="line">        <span class="keyword">raise</span> ValueError</span><br><span class="line">    v4 = a1</span><br><span class="line">    scanned = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> v2:</span><br><span class="line">        v5 = v8</span><br><span class="line">        v6 = <span class="number">0x14</span> <span class="keyword">if</span> v2&gt;<span class="number">0x14</span> <span class="keyword">else</span> v2</span><br><span class="line">        v2 = v2 - v6</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(v6):</span><br><span class="line">            v5 = v5 + a1[scanned]</span><br><span class="line">            v5 = v5 &amp; <span class="number">0xFFFF</span></span><br><span class="line">            v3 = v3 + v5</span><br><span class="line">            v3 = v3 &amp; <span class="number">0xFFFF</span></span><br><span class="line">            scanned = scanned + <span class="number">1</span></span><br><span class="line">            <span class="comment">#print(&quot;% 3d - % 3d&quot;%(scanned, v6))</span></span><br><span class="line">        v8 = (v5 &gt;&gt; <span class="number">8</span>) + (<span class="number">0xff</span>&amp;v5)</span><br><span class="line">        v8 = v8 &amp; <span class="number">0xFFFF</span></span><br><span class="line">        v3 = (v3 &gt;&gt; <span class="number">8</span>) + (<span class="number">0xff</span>&amp;v3)</span><br><span class="line">        v3 = v3 &amp; <span class="number">0xFFFF</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;=== % 4x = % 4x ===&quot;</span>%(v8,v3))</span><br><span class="line">    <span class="keyword">return</span> ( (v8 &gt;&gt; <span class="number">8</span>) + ((<span class="number">0xFF</span>) &amp; v8) ) | ( <span class="number">0xFFFF</span> &amp; ( (v3 &lt;&lt; <span class="number">8</span>) + ((<span class="number">0xFF00</span>) &amp; v3) ) )</span><br><span class="line">        </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">check</span>(<span class="params">xk</span>):</span></span><br><span class="line">    borg = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">    33 E1 C4 99 </span></span><br><span class="line"><span class="string">    11 06 81 16 F0 32 9F C4  91 17 06 81 14 F0 06 81 </span></span><br><span class="line"><span class="string">    15 F1 C4 91 1A 06 81 1B  E2 06 81 18 F2 06 81 19 </span></span><br><span class="line"><span class="string">    F1 06 81 1E F0 C4 99 1F  C4 91 1C 06 81 1D E6 06 </span></span><br><span class="line"><span class="string">    81 62 EF 06 81 63 F2 06  81 60 E3 C4 99 61 06 81 </span></span><br><span class="line"><span class="string">    66 BC 06 81 67 E6 06 81  64 E8 06 81 65 9D 06 81 </span></span><br><span class="line"><span class="string">    6A F2 C4 99 6B 06 81 68  A9 06 81 69 EF 06 81 6E </span></span><br><span class="line"><span class="string">    EE 06 81 6F AE 06 81 6C  E3 06 81 6D EF 06 81 72 </span></span><br><span class="line"><span class="string">    E9 06 81 73 7C &quot;&quot;&quot;</span></span><br><span class="line">    bbs = [(<span class="number">0xff</span>&amp;((i^xk)+<span class="number">0x22</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>(<span class="built_in">bytes</span>.fromhex(borg.replace(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>)))]</span><br><span class="line">    <span class="keyword">return</span> generator(bbs, <span class="number">0x79</span>)</span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0xff</span>):</span><br><span class="line">    <span class="keyword">if</span> ( check(i) == <span class="number">0xFB5E</span> ):</span><br><span class="line">        j=i</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># j = 0xa2</span></span><br><span class="line"><span class="comment"># Now it is time to check bytes</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0x79</span>):</span><br><span class="line">    ida_bytes.patch_byte(<span class="number">0x40107c</span>+i, ida_bytes.get_byte(<span class="number">0x40107c</span>+i)^j)</span><br><span class="line"><span class="comment"># et_tu_brute_force@flare-on.com</span></span><br></pre></td></tr></table></figure>

<h2 id="Notepad"><a href="#Notepad" class="headerlink" title="Notepad"></a>Notepad</h2><p>这个题目就略坑了。。<br>此题wp参考 杜师傅 <a href="https://bbs.xdsec.club/d/116-flare-on-4-challange-problem-1-11-writeup">https://bbs.xdsec.club/d/116-flare-on-4-challange-problem-1-11-writeup</a></p>
<p>一道侧重于样本分析的程序。源程序是Windows的记事本，被在另一个段注入了新代码，并修改了OEP。新代码会使用ROR13获取所有加载模块的哈希，并按照如下算法比较并存储之</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">module</span> in PEB-&gt;LDRDATA-&gt;InMemoryOrderModuleList</span><br><span class="line">    <span class="function"><span class="keyword">if</span> <span class="title">HashROR13</span><span class="params">(<span class="keyword">module</span>.name)</span></span>==HashROR13(TargetModuleName):</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">module</span> <span class="meta"># for futher usage ;)</span></span><br></pre></td></tr></table></figure>
<p>注意的是，在我的Windows 10中，这段程序会出问题，因为由于一些未知的原因，这段代码在我机器上获取的模块名称为大写，而ROR13的实现是区分大小写的。我们在0x10153F6下断点，断点日志为Parsing {s:edx}，查看日志：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">Parsing L<span class="string">&quot;4_notepad.exe&quot;</span></span><br><span class="line">Parsing L<span class="string">&quot;ntdll.DLL&quot;</span></span><br><span class="line">Parsing L<span class="string">&quot;KERNEL32.DLL&quot;</span></span><br><span class="line">Parsing L<span class="string">&quot;KERNELBASE.dll&quot;</span></span><br><span class="line">Parsing L<span class="string">&quot;comdlg32.dll&quot;</span></span><br></pre></td></tr></table></figure>


<p>可以发现KERNEL32被跳过了。patch掉此处，便于动态调试。</p>
<p>对于被调用的函数，我们可以用Flare-IDA中的Shellcode-hashes脚本来辅助分析。静态分析后发现，程序在遍历%USERPROFILE%/flareon2016challenge目录下的文件，检查其时间是否符合特征值。如果符合，就提取出其中的八个字节到key.bin中，以此类推。Swings师傅提醒后，发现正确的文件是从去年的题目包中下载的（P.S 我觉得这个题设计的一般）。释放文件后再次执行程序，会弹出对话框：</p>
<p><a href="mailto:&#98;&#x6c;&#x34;&#53;&#55;&#x5f;&#102;&#x72;&#48;&#109;&#x5f;&#x74;&#x68;&#x33;&#95;&#x70;&#x34;&#x35;&#x37;&#x40;&#x66;&#x6c;&#97;&#x72;&#x65;&#45;&#111;&#x6e;&#46;&#x63;&#111;&#x6d;">&#98;&#x6c;&#x34;&#53;&#55;&#x5f;&#102;&#x72;&#48;&#109;&#x5f;&#x74;&#x68;&#x33;&#95;&#x70;&#x34;&#x35;&#x37;&#x40;&#x66;&#x6c;&#97;&#x72;&#x65;&#45;&#111;&#x6e;&#46;&#x63;&#111;&#x6d;</a></p>
<h2 id="Pewpewboat"><a href="#Pewpewboat" class="headerlink" title="Pewpewboat"></a>Pewpewboat</h2><p>这是一个linux下的游戏<br>关卡有100关，<br>我们在静态分析下main函数</p>
<div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-pewpewboat-01.jpg)
</div>




<p>该函数genInitialSeed (0x403C85)生成用于“解密”游戏数据的初始种子。我会让你读它，但它本质上MD5是”loading… %d%%”一个循环中的字符串，%d每次递增。<br>然后，我们将看到99个级别的循环，每次迭代从576个字节的表复制游戏数据，然后使用以下命令解密它seed</p>
<p>我们可以进看一下他的循环</p>
<div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-pewpewboat-02.jpg)
</div>



<p>从drawGrid (0x403263)功能上我们可以看到，我们输入的坐标和“船”的实际位置都存储在gameState。该代码将根据用户输入的坐标来检查正确的坐标，并且只有在有匹配的情况下才绘制</p>
<div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-pewpewboat-03.jpg)
</div>




<p>我们继续process (0x04038D6)处理从用户输入的功能，检查命中并根据需要提前游戏状态。在这个功能中，你将会看到游戏状态中的更多内容，比如你的排名（例如“Seaman Recruit”）：</p>
<h3 id="解题-3"><a href="#解题-3" class="headerlink" title="解题"></a>解题</h3><p>回到游戏流程。每轮游戏中，你的输入值除了会影响DiskStatus外，还会被原样放到上面结构体的LastInputUpperCase中。如果对应的点在GoodStatus中为True，那么就算击中。此外，每轮游戏中，checksum值都会变，用来解密下一轮游戏。</p>
<p>所以我们通过解数据的方式解决</p>
<div align=center>
![](https://blog-1252049492.cos.ap-hongkong.myqcloud.com/img/17-flare-on-pewpewboat-04.jpg)</div>





<p>这个程序算出来的值的前8个字节就是这关的过关关键</p>
<p>依次过关之后会出现</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Aye! You found some letters did ya? To find what you<span class="string">&#x27;re looking for, you&#x27;</span>ll want to re-order them: 9, 1, 2, 7, 3, 5, 6, 5, 8, 0, 2, 3, 5, 6, 1, 4. Next you <span class="built_in">let</span> 13 ROT <span class="keyword">in</span> the sea! THE FINAL SECRET CAN BE FOUND WITH ONLY THE UPPER CASE</span><br></pre></td></tr></table></figure>
<p>的提示</p>
<p>重新组织地图字母FHGUZREJVO得到OHGJURERVFGUREHZ<br>rot13之后得到BUTWHEREISTHERUM</p>
<p>直接输入到程序中就得到flag了。。</p>
<p><a href="mailto:&#121;&#48;&#x75;&#x5f;&#x5f;&#x73;&#85;&#x6e;&#x4b;&#x5f;&#109;&#89;&#95;&#x5f;&#x50;&#51;&#87;&#x70;&#51;&#x77;&#95;&#x62;&#48;&#52;&#x74;&#64;&#102;&#x6c;&#x61;&#114;&#x65;&#45;&#x6f;&#x6e;&#x2e;&#99;&#x6f;&#x6d;">&#121;&#48;&#x75;&#x5f;&#x5f;&#x73;&#85;&#x6e;&#x4b;&#x5f;&#109;&#89;&#95;&#x5f;&#x50;&#51;&#87;&#x70;&#51;&#x77;&#95;&#x62;&#48;&#52;&#x74;&#64;&#102;&#x6c;&#x61;&#114;&#x65;&#45;&#x6f;&#x6e;&#x2e;&#99;&#x6f;&#x6d;</a></p>
<p>今晚先写到这。。明天继续写</p>
<h2 id="Payload"><a href="#Payload" class="headerlink" title="Payload"></a>Payload</h2><h2 id="突然发现国内有有人写的挺完整的-我就不继续往下写了"><a href="#突然发现国内有有人写的挺完整的-我就不继续往下写了" class="headerlink" title="突然发现国内有有人写的挺完整的 我就不继续往下写了"></a>突然发现国内有有人写的挺完整的 我就不继续往下写了</h2><p>突然发现国内有有人写的挺完整的 我就不继续往下写了<br>附上连接<br><a href="http://blog.nsfocus.net/flare-onchallenge4th/">http://blog.nsfocus.net/flare-onchallenge4th/</a></p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>
  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/link">Links</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ROT13"><span class="toc-number">1.</span> <span class="toc-text">ROT13</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A2%98%E9%9D%A2"><span class="toc-number">1.1.</span> <span class="toc-text">题面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98"><span class="toc-number">1.2.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Igniteme"><span class="toc-number">2.</span> <span class="toc-text">Igniteme</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-1"><span class="toc-number">2.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Greektome"><span class="toc-number">3.</span> <span class="toc-text">Greektome</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-2"><span class="toc-number">3.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Notepad"><span class="toc-number">4.</span> <span class="toc-text">Notepad</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Pewpewboat"><span class="toc-number">5.</span> <span class="toc-text">Pewpewboat</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E9%A2%98-3"><span class="toc-number">5.1.</span> <span class="toc-text">解题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Payload"><span class="toc-number">6.</span> <span class="toc-text">Payload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AA%81%E7%84%B6%E5%8F%91%E7%8E%B0%E5%9B%BD%E5%86%85%E6%9C%89%E6%9C%89%E4%BA%BA%E5%86%99%E7%9A%84%E6%8C%BA%E5%AE%8C%E6%95%B4%E7%9A%84-%E6%88%91%E5%B0%B1%E4%B8%8D%E7%BB%A7%E7%BB%AD%E5%BE%80%E4%B8%8B%E5%86%99%E4%BA%86"><span class="toc-number">7.</span> <span class="toc-text">突然发现国内有有人写的挺完整的 我就不继续往下写了</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bestwing.me/2017-flare-on-write-up.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bestwing.me/2017-flare-on-write-up.html&text=Flare on writeup 2017 writeup"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bestwing.me/2017-flare-on-write-up.html&is_video=false&description=Flare on writeup 2017 writeup"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Flare on writeup 2017 writeup&body=Check out this article: https://bestwing.me/2017-flare-on-write-up.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bestwing.me/2017-flare-on-write-up.html&title=Flare on writeup 2017 writeup"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bestwing.me/2017-flare-on-write-up.html&name=Flare on writeup 2017 writeup&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://bestwing.me/2017-flare-on-write-up.html&t=Flare on writeup 2017 writeup"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2016-2024
    Swing
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/search">Search</a></li>
         
          <li><a href="/atom.xml">RSS</a></li>
         
          <li><a href="/categories/">Categories</a></li>
         
          <li><a href="/link">Links</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-133464311-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-133464311-1');
    </script>

<!-- Baidu Analytics -->

  <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
          var hm = document.createElement("script");
          hm.src = "https://hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
          var s = document.getElementsByTagName("script")[0];
          s.parentNode.insertBefore(hm, s);
        })();
        </script>

<!-- Umami Analytics -->

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'swing';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
