<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="稍微整理了一下 做过的RSA题目 从简单到难">
<meta property="og:type" content="article">
<meta property="og:title" content="一大波RSA就要来了~~">
<meta property="og:url" content="https://bestwing.me/Common-types-of-RSA.html">
<meta property="og:site_name" content="Swing&#39;Blog 有恨无人省">
<meta property="og:description" content="稍微整理了一下 做过的RSA题目 从简单到难">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://oayoilchh.bkt.clouddn.com/RSA_yafu.png">
<meta property="og:image" content="http://oayoilchh.bkt.clouddn.com/RSA_Publkey.png">
<meta property="og:image" content="http://oayoilchh.bkt.clouddn.com/RSA_Rabin.png">
<meta property="article:published_time" content="2016-09-09T16:16:14.000Z">
<meta property="article:modified_time" content="2019-09-24T13:53:06.000Z">
<meta property="article:author" content="Swing">
<meta property="article:tag" content="Crypto">
<meta property="article:tag" content="RSA">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://oayoilchh.bkt.clouddn.com/RSA_yafu.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>一大波RSA就要来了~~</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
      
<link rel="stylesheet" href="/css/rtl.css">

    
    <!-- rss -->
    
    
      <link rel="alternate" href="/atom.xml" title="Swing&#39;Blog 有恨无人省" type="application/atom+xml" />
    
<meta name="generator" content="Hexo 5.2.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="https://bestwing.me">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/link">Links</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
         
          <li><a href="/categories/">categories</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2016-Hs-ctf-SeeSea-writeup.html"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2016-ichunqiu-September.html"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">上一篇</span>
      <span id="i-next" class="info" style="display:none;">下一篇</span>
      <span id="i-top" class="info" style="display:none;">返回顶部</span>
      <span id="i-share" class="info" style="display:none;">分享文章</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bestwing.me/Common-types-of-RSA.html"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bestwing.me/Common-types-of-RSA.html&text=一大波RSA就要来了~~"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bestwing.me/Common-types-of-RSA.html&is_video=false&description=一大波RSA就要来了~~"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=一大波RSA就要来了~~&body=Check out this article: https://bestwing.me/Common-types-of-RSA.html"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bestwing.me/Common-types-of-RSA.html&name=一大波RSA就要来了~~&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://bestwing.me/Common-types-of-RSA.html&t=一大波RSA就要来了~~"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA%E2%80%93%E6%B1%82d"><span class="toc-number">1.</span> <span class="toc-text">RSA–求d</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3-%E7%AC%A8%E5%8A%9E%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">自己代码解决  笨办法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python%E6%A8%A1%E5%9D%97%E8%A7%A3%E5%86%B3"><span class="toc-number">1.2.</span> <span class="toc-text">python模块解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%AB%E4%BA%BA%E5%B7%B2%E7%BB%8F%E5%86%99%E5%A5%BD%E7%9A%84%E5%B7%A5%E5%85%B7-%E5%8D%B3rsatool-py"><span class="toc-number">1.3.</span> <span class="toc-text">别人已经写好的工具 即rsatool.py</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%B1%82%E6%98%8E%E6%96%87-N%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%88%86%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">基础求明文-N已经被分解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%B1%82%E6%98%8E%E6%96%87-N%E6%9C%AA%E8%A2%AB%E5%88%86%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">基础求明文-N未被分解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yafu%E9%85%8D%E5%90%88rsatool-py-python"><span class="toc-number">3.1.</span> <span class="toc-text">yafu配合rsatool.py + python</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#512%E4%BD%8D%E7%9A%84%E5%A4%A7%E5%AE%B6%E4%BC%99"><span class="toc-number">4.</span> <span class="toc-text">512位的大家伙</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E8%A7%A3%E5%86%B3"><span class="toc-number">4.1.</span> <span class="toc-text">Python解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#openssl%E8%A7%A3%E5%86%B3"><span class="toc-number">4.2.</span> <span class="toc-text">openssl解决</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hard-RSA"><span class="toc-number">5.</span> <span class="toc-text">hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Very-Hard-RSA"><span class="toc-number">6.</span> <span class="toc-text">Very Hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Extremely-hard-RSA"><span class="toc-number">7.</span> <span class="toc-text">Extremely hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gold-LIke-RSA"><span class="toc-number">8.</span> <span class="toc-text">Gold LIke RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSANG"><span class="toc-number">9.</span> <span class="toc-text">RSANG</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#since-sometimes-the-solution-will-consist-of-complex-numbers-we%E2%80%99ll-just-disregard-those-with-a-try-except"><span class="toc-number">10.</span> <span class="toc-text">since sometimes the solution will consist of complex numbers, we’ll just disregard those with a try-except</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        一大波RSA就要来了~~
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Swing'Blog 有恨无人省</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2016-09-09T16:16:14.000Z" itemprop="datePublished">2016-09-10</time>
        
      
    </div>


      
    <div class="article-category">
        <i class="fas fa-archive"></i>
        <a class="category-link" href="/categories/Summary/">Summary</a>
    </div>


      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/Crypto/" rel="tag">Crypto</a>, <a class="tag-link-link" href="/tags/RSA/" rel="tag">RSA</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"<h1 id="先不说RSA原理-我也懒得重复的造轮子"><a href="#先不说RSA原理-我也懒得重复的造轮子" class="headerlink" title="先不说RSA原理  我也懒得重复的造轮子"></a>先不说RSA原理  我也懒得重复的造轮子</h1><h1 id="RSA–求d"><a href="#RSA–求d" class="headerlink" title="RSA–求d"></a>RSA–求d</h1><p>在一次RSA密钥对生成中，假设p=473398607161，q=4511491，e=17</p>
<p>求解出d</p>
<p>将得到的d提交：</p>
<p>题目很简单 有取巧的方法 也有笨方法</p>
<h2 id="自己代码解决-笨办法"><a href="#自己代码解决-笨办法" class="headerlink" title="自己代码解决  笨办法"></a>自己代码解决  笨办法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">p = int(raw_input(<span class="string">&quot;Enter a p: &quot;</span>))   </span><br><span class="line">q = int(raw_input(<span class="string">&quot;Enter a q: &quot;</span>))  </span><br><span class="line">e = int(raw_input(<span class="string">&quot;Enter a e: &quot;</span>))   </span><br><span class="line">t = (p<span class="number">-1</span>)*(q<span class="number">-1</span>)   </span><br><span class="line">i=<span class="number">0</span>  </span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span> :   </span><br><span class="line">	<span class="keyword">if</span> (<span class="number">1</span>-t*i)%e == <span class="number">0</span>:   </span><br><span class="line">		<span class="keyword">break</span>   </span><br><span class="line">	i-=<span class="number">1</span>   </span><br><span class="line">	<span class="keyword">print</span> i </span><br><span class="line"><span class="keyword">print</span> <span class="string">&#x27;ok:&#x27;</span> + <span class="string">&#x27;%d&#x27;</span> % ((<span class="number">1</span>-t*i)/e)</span><br></pre></td></tr></table></figure>
<p>脚本写得老粗糙</p>
<h2 id="python模块解决"><a href="#python模块解决" class="headerlink" title="python模块解决"></a>python模块解决</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">p = int(raw_input(<span class="string">&quot;Enter a p: &quot;</span>))   </span><br><span class="line">q = int(raw_input(<span class="string">&quot;Enter a q: &quot;</span>))  </span><br><span class="line">e = int(raw_input(<span class="string">&quot;Enter a e: &quot;</span>))   </span><br><span class="line">gmpy2.invert(e, (p<span class="number">-1</span>)*(q<span class="number">-1</span>)) `</span><br></pre></td></tr></table></figure>
<h2 id="别人已经写好的工具-即rsatool-py"><a href="#别人已经写好的工具-即rsatool-py" class="headerlink" title="别人已经写好的工具 即rsatool.py"></a>别人已经写好的工具 即rsatool.py</h2><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rsatool.py -p <span class="number">473398607161</span> -q <span class="number">451149</span> <span class="number">84376578389</span> -e <span class="number">17</span> </span><br></pre></td></tr></table></figure>
<h1 id="基础求明文-N已经被分解"><a href="#基础求明文-N已经被分解" class="headerlink" title="基础求明文-N已经被分解"></a>基础求明文-N已经被分解</h1><p>在一次RSA密钥对生成中，假设p=473398607161，q=4511491，e=17</p>
<p>某个明文加密后的结果为：727835100378484285<br>将得到的明文提交：<br>既然以及有了p，q那么就可以拿到私钥了</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">rsatool.py -p <span class="number">473398607161</span> -q <span class="number">4511491</span> -e <span class="number">17</span></span><br><span class="line">Using (p, q) to initialise RSA instance</span><br><span class="line"></span><br><span class="line">n = <span class="number">2135733555619387051</span> (<span class="number">0x1da3a65a6d9356ab</span>)</span><br><span class="line"></span><br><span class="line">e = <span class="number">17</span> (<span class="number">0x11</span>)</span><br><span class="line"></span><br><span class="line">d = <span class="number">125631357777427553</span> (<span class="number">0x1be550de4f93c61</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">473398607161</span> (<span class="number">0x6e38c17d39</span>)</span><br><span class="line"></span><br><span class="line">q = <span class="number">4511491</span> (<span class="number">0x44d703</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">print</span> (<span class="string">&#x27;%x&#x27;</span> % pow(<span class="number">727835100378484285</span>,<span class="number">125631357777427553</span>,<span class="number">2135733555619387051</span>)).decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">testMe!</span><br></pre></td></tr></table></figure>
<h1 id="基础求明文-N未被分解"><a href="#基础求明文-N未被分解" class="headerlink" title="基础求明文-N未被分解"></a>基础求明文-N未被分解</h1><p>N = 322831561921859， e = 23，cipher = 0xdc2eeeb2782c</p>
<p>题目没有上一题给的p，和q，所以得对N进行分解 </p>
<h2 id="yafu配合rsatool-py-python"><a href="#yafu配合rsatool-py-python" class="headerlink" title="yafu配合rsatool.py + python"></a>yafu配合rsatool.py + python</h2><p>这个题目和上面题目的区别就是N没有被分解 用<code>yafu</code>这个工具可以进行大数字分解<br><a href="http://oayoilchh.bkt.clouddn.com/RSA_yafu.png" class="gallery-item"><img src="http://oayoilchh.bkt.clouddn.com/RSA_yafu.png"></a><br>然后剩下的方法和上面差不多就不累加叙述了</p>
<h1 id="512位的大家伙"><a href="#512位的大家伙" class="headerlink" title="512位的大家伙"></a>512位的大家伙</h1><p>你没看错，这还真是密码学系列了，相信你已经解出前两题了，那么继续看这题吧。<br>链接：<a href="http://pan.baidu.com/s/1o77LozK">http://pan.baidu.com/s/1o77LozK</a> 密码：1ik4</p>
<p>这个题目第一次遇到的时候我碰到了一个麻烦 就是不知怎么提取公钥<br>两个方法</p>
<h2 id="Python解决"><a href="#Python解决" class="headerlink" title="Python解决"></a>Python解决</h2><p>利用python的<code>Crypto</code></p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.PublicKey <span class="keyword">import</span> RSA</span><br><span class="line">A = RSA.importKey(open(<span class="string">&#x27;pem文件名字&#x27;</span>).read())</span><br><span class="line">A.n</span><br><span class="line">A.e</span><br></pre></td></tr></table></figure>
<p>如图 就得到了公钥<br><a href="http://oayoilchh.bkt.clouddn.com/RSA_Publkey.png" class="gallery-item"><img src="http://oayoilchh.bkt.clouddn.com/RSA_Publkey.png"></a><br>然后剩下的步骤依旧就是 分解N 生成私钥 解密</p>
<h2 id="openssl解决"><a href="#openssl解决" class="headerlink" title="openssl解决"></a>openssl解决</h2><p>提取公钥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -outform PEM -in server&#x2F;server.crt -pubkey -out server&#x2F;server.pubkey</span><br></pre></td></tr></table></figure>
<h1 id="hard-RSA"><a href="#hard-RSA" class="headerlink" title="hard RSA"></a>hard RSA</h1><p>相信你已经做出了medium RSA，这题的pubkey在medium RSA的基础上我做了点手脚，继续挑战吧。<br>Hint1: 1.不需要爆破。2.用你的数学知识解决此题。3.难道大家都不会开根号吗？<br>链接：<a href="http://pan.baidu.com/s/1kVxYmiV">http://pan.baidu.com/s/1kVxYmiV</a> 密码：oix5</p>
<p> 考验大家数学知识的来了</p>
<p>这个题目和上个题目的相同之处是 N是一样的 但是这个题目的 e = 2<br>e一样 这个题目应该是    <code>Rabin</code>密码<br><a href="http://oayoilchh.bkt.clouddn.com/RSA_Rabin.png" class="gallery-item"><img src="http://oayoilchh.bkt.clouddn.com/RSA_Rabin.png"></a><br>直接给脚本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">f = open(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">c = f.read()</span><br><span class="line">c = libnum.s2n(c)</span><br><span class="line">p = <span class="number">275127860351348928173285174381581152299</span></span><br><span class="line">q = <span class="number">319576316814478949870590164193048041239</span></span><br><span class="line">n = p*q</span><br><span class="line">r = pow(c,(p+<span class="number">1</span>)/<span class="number">4</span>,p)</span><br><span class="line">s = pow(c,(q+<span class="number">1</span>)/<span class="number">4</span>,q)</span><br><span class="line">a = gmpy2.invert(p,q)</span><br><span class="line">b = gmpy2.invert(q,p)</span><br><span class="line">x =(a*p*s+b*q*r)%n</span><br><span class="line">y =(a*p*s-b*q*r)%n</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(x%n)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s((-x)%n)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s(y%n)</span><br><span class="line"><span class="keyword">print</span> libnum.n2s((-y)%n)</span><br></pre></td></tr></table></figure>
<h1 id="Very-Hard-RSA"><a href="#Very-Hard-RSA" class="headerlink" title="Very Hard RSA"></a>Very Hard RSA</h1><p>前几题因为N太小，都被你攻破了，出题人这次来了个RSA4096，是否接受挑战就看你了。<br>链接：<a href="http://pan.baidu.com/s/1jIq8IKA">http://pan.baidu.com/s/1jIq8IKA</a> 密码：k43g</p>
<p>对于这个题目 我们会发现 是用相同的N，不同的e进行加密的 </p>
<p>这里有个技巧 如果我们发现 N相同 e不同其实我们可以用共模攻击</p>
<p>原理不说 直接给脚本</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> n2s,s2n</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> invert</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span>(<span class="params">a, b</span>):</span></span><br><span class="line">  <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">    <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="keyword">else</span>:</span><br><span class="line">    g, y, x = egcd(b % a, a)</span><br><span class="line">    <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">  <span class="comment"># 输入参数</span></span><br><span class="line">  <span class="comment"># fo1 = open(&#x27;flag.enc1&#x27;, &#x27;rb&#x27;)</span></span><br><span class="line">  <span class="comment"># fo2 = open(&#x27;flag.enc2&#x27;, &#x27;rb&#x27;)</span></span><br><span class="line">  <span class="comment"># c1 =  fo1.read()</span></span><br><span class="line">  <span class="comment"># c2 =  fo2.read()</span></span><br><span class="line">  n = <span class="number">116547141139745534253172934123407786743246513874292261984447028928003798881819567221547298751255790928878194794155722543477883428672342894945552668904410126460402501558930911637857436926624838677630868157884406020858164140754510239986466552869866296144106255873879659676368694043769795604582888907403261286211</span></span><br><span class="line">  c1 = <span class="number">78552378607874335972488545767374401332953345586323262531477516680347117293352843468592985447836452620945707838830990843415342047337735534418287912723395148814463617627398248738969202758950481027762126608368555442533803610260859075919831387641824493902538796161102236794716963153162784732179636344267189394853</span></span><br><span class="line">  c2 = <span class="number">98790462909782651815146615208104450165337326951856608832305081731255876886710141821823912122797166057063387122774480296375186739026132806230834774921466445172852604926204802577270611302881214045975455878277660638731607530487289267225666045742782663867519468766276566912954519691795540730313772338991769270201</span></span><br><span class="line">  e1 = <span class="number">1804229351</span></span><br><span class="line">  e2 = <span class="number">17249876309</span></span><br><span class="line">  s = egcd(e1, e2)</span><br><span class="line">  s1 = s[<span class="number">1</span>]</span><br><span class="line">  s2 = s[<span class="number">2</span>]</span><br><span class="line">  <span class="comment"># 求模反元素</span></span><br><span class="line">  <span class="keyword">if</span> s1&lt;<span class="number">0</span>:</span><br><span class="line">    s1 = - s1</span><br><span class="line">    c1 = invert(c1, n)</span><br><span class="line">  <span class="keyword">elif</span> s2&lt;<span class="number">0</span>:</span><br><span class="line">    s2 = - s2</span><br><span class="line">    c2 = invert(c2, n)</span><br><span class="line"></span><br><span class="line">  m = pow(c1,s1,n)*pow(c2,s2,n) % n</span><br><span class="line">  <span class="keyword">print</span> n2s(m)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">  main()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Extremely-hard-RSA"><a href="#Extremely-hard-RSA" class="headerlink" title="Extremely hard RSA"></a>Extremely hard RSA</h1><p>没想到RSA4096都被你给破了，一定是我的问题，给了你太多信息，这次我只给你一个flag的加密值和公钥，仍然是RSA4096，我就不信你还能解出来。<br>链接：<a href="http://pan.baidu.com/s/1skBIUuD">http://pan.baidu.com/s/1skBIUuD</a> 密码：xvfr<br> 题目的重点是：<br>公钥中，e=3，N非常大。所以可以不断地c+N然后开三次方，直接写代码爆破<br>这里直接用白师傅写的的脚本  </p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">__author__ = <span class="string">&#x27;ByStudent&#x27;</span></span><br><span class="line"><span class="keyword">from</span> libnum <span class="keyword">import</span> s2n,n2s</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> iroot</span><br><span class="line">n = <span class="number">0xB0BEE5E3E9E5A7E8D00B493355C618FC8C7D7D03B82E409951C182F398DEE3104580E7BA70D383AE5311475656E8A964D380CB157F48C951ADFA65DB0B122CA40E42FA709189B719A4F0D746E2F6069BAF11CEBD650F14B93C977352FD13B1EEA6D6E1DA775502ABFF89D3A8B3615FD0DB49B88A976BC20568489284E181F6F11E270891C8EF80017BAD238E363039A458470F1749101BC29949D3A4F4038D463938851579C7525A69984F15B5667F34209B70EB261136947FA123E549DFFF00601883AFD936FE411E006E4E93D1A00B0FEA541BBFC8C5186CB6220503A94B2413110D640C77EA54BA3220FC8F4CC6CE77151E29B3E06578C478BD1BEBE04589EF9A197F6F806DB8B3ECD826CAD24F5324CCDEC6E8FEAD2C2150068602C8DCDC59402CCAC9424B790048CCDD9327068095EFA010B7F196C74BA8C37B128F9E1411751633F78B7B9E56F71F77A1B4DAAD3FC54B5E7EF935D9A72FB176759765522B4BBC02E314D5C06B64D5054B7B096C601236E6CCF45B5E611C805D335DBAB0C35D226CC208D8CE4736BA39A0354426FAE006C7FE52D5267DCFB9C3884F51FDDFDF4A9794BCFE0E1557113749E6C8EF421DBA263AFF68739CE00ED80FD0022EF92D3488F76DEB62BDEF7BEA6026F22A1D25AA2A92D124414A8021FE0C174B9803E6BB5FAD75E186A946A17280770F1243F4387446CCCEB2222A965CC30B3929</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">f = open(<span class="string">&#x27;flag.enc&#x27;</span>,<span class="string">&#x27;rb&#x27;</span>)</span><br><span class="line">c= f.read()</span><br><span class="line">c = s2n(c)</span><br><span class="line">f.close()</span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    res = iroot(c+i*n,<span class="number">3</span>)</span><br><span class="line">    <span class="keyword">if</span>(res[<span class="number">1</span>] == <span class="literal">True</span>):</span><br><span class="line">        <span class="keyword">print</span> res</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;i=&quot;</span>+str(i)</span><br><span class="line">    i = i+<span class="number">1</span></span><br><span class="line"><span class="comment">#i=118719487</span></span><br><span class="line">m = <span class="number">440721643740967258786371951429849843897639673893942371730874939742481383302887786063966117819631425015196093856646526738786745933078032806737504580146717737115929461581126895844008044713461807791172016433647699394456368658396746134702627548155069403689581548233891848149612485605022294307233116137509171389596747894529765156771462793389236431942344003532140158865426896855377113878133478689191912682550117563858186</span></span><br><span class="line"><span class="keyword">print</span> n2s(m)</span><br><span class="line"><span class="comment"># 结果</span></span><br><span class="line"><span class="comment"># Didn&#x27;t you know RSA padding is really important? Now you see a non-padding message is so dangerous. And you should notice this in future.Fl4g: PCTF&#123;Sm4ll_3xpon3nt_i5_W3ak&#125;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="Gold-LIke-RSA"><a href="#Gold-LIke-RSA" class="headerlink" title="Gold LIke RSA"></a>Gold LIke RSA</h1><p>这个题是到最后 i春秋把汪师傅的题上上去之后我才终于做出来的</p>
<p>既然你逼我到绝境，那就休怪我不客气了，代表上帝挑战你~<br>链接：<a href="http://pan.baidu.com/s/1qX7HmyS">http://pan.baidu.com/s/1qX7HmyS</a> 密码：4vjz</p>
<p>后来才知道这个题是PCTF的一道题目改的  <a href="http://mslc.ctf.su/wp/plaidctf-2014-rsa-writeup/">原题地址</a><br>先停在这 明天在写 </p>
<h1 id="RSANG"><a href="#RSANG" class="headerlink" title="RSANG"></a>RSANG</h1><p>尝试着对N分解<br>模量对数<br>看起来像形式的数字$N = (2^M + a)(2^M + b)(2^M + c)(2^M + d) $.<br>日志基 2 的弹性模量是 5568 所以$M=1392$.<br>我们现在可以做一些数学，看看什么信息，我们可以摆脱 4 二进制序列︰</p>
<p>$$ N = (2^M + a)(2^M +b)(2^M +c)(2^M +d) $$</p>
<p>$$ N = 2^{4M} + 2^{3M}(a + b + c + d) + 2^{2M}(ab + ac + ad + bc + bd + cd) + 2^M(bcd + acd + abd + abc) + abcd $$</p>
<p>让︰<br>$$ p = a + b + c + d $$</p>
<p>$$ q = ab + ac + ad + bc + bd + cd $$</p>
<p>$$ r = bcd + acd + abd + abc $$</p>
<p>$$ s = abcd $$</p>
<p>你会忍不住想上述 4 的二进制字符序列对应直接到$p$， $q$， $r$， $s$ ，但这里面有蹊跷︰ 只有$s$等于其各自的二进制序列。<br>其他的可能会在 0 或更多，因为奇数偶数有甚至总和。我们可以只是强制性，但它，所以我们会担心以后。<br>我们如何找出$a$， $b$，$c$和$d$给定$p$， $q$， $r$ ， $s$？高中数学的救援︰</p>
<p>$$ (X - x_1)(X - x_2)(X - x_3)(X - x_4) = 0 $$</p>
<p>$$ X^4 -(x_1 + x_2 + x_3 + x_4)X^3 + (x_1 x_2 + x_1 x_3 + x_1 x_4 + x_2 x_3 + x_2 x_4 + x_3 x_4)X^2 - (x_2 x_3 x_4 + x_1 x_3 x_4 + x_1 x_2 x_4 + x_1 x_2 x_3)X + x_1 x_2 x_3 x_4 = 0 $$<br>import math<br>import gmpy2<br>gmpy2.get_context().precision=5000<br>from polycubicroot import *<br>def Carpenter(p, q,r, s):<br>p = gmpy2.mpfr(p)<br>q = gmpy2.mpfr(q)<br>r = gmpy2.mpfr(r)<br>s = gmpy2.mpfr(s)<br>“””<br>Solves for all roots of the quartic polynomial P(x) = x^4 + px^3 + qx^2 + rx + s.<br>“””<br>#print “@@@ inside Carpenter”, p,q,r,s<br>pby4 = p/4.0<br>C = ((6 * pby4) - 3<em>p)<em>pby4 + q<br>D = (((-4</em>pby4) + 3</em>p)<em>pby4 - 2</em>q)<em>pby4 + r<br>E = (((pby4 - p)</em> pby4 + q)<em>pby4 - r)<em>pby4 + s<br>#print “C, D, E=”,C, D, E<br>root = None<br>for zero in polyCubicRoots(2</em>C, (C**2 - 4</em>E), -D<strong>2):<br>#print “zero = “, zero<br>if type(zero)== type(gmpy2.mpfr(1.0)) and zero &gt; 0.0:<br>root = zero<br>#print “found a positive root.”<br>break<br>if root == None:<br>return None<br>sqroot = gmpy2.sqrt(root)<br>Q1 = -root/4.0 - C/2.0 - D/2.0 / sqroot<br>Q2 = -root/4.0 - C/2.0 + D/2.0 / sqroot<br>#print “Q1,Q2=”, Q1, Q2<br>sqy2 = sqroot/2.0<br>if Q1 &gt;= 0.0:<br>sqQ1 = gmpy2.sqrt(Q1)<br>z1 = sqy2 + sqQ1 -pby4<br>z2 = sqy2 - sqQ1 -pby4<br>else:<br>sqQ1 = gmpy2.sqrt(-Q1)<br>z1 = (sqy2-pby4, sqQ1)<br>z2 = (sqy2-pby4, - sqQ1)<br>if Q2 &gt;= 0.0:<br>sqQ2 = gmpy2.sqrt(Q2)<br>z3 = -sqy2 - sqQ2 -pby4<br>z4 = -sqy2 + sqQ2 -pby4<br>else:<br>sqQ2 = gmpy2.sqrt(-Q2)<br>z3 = (-sqy2-pby4, sqQ2)<br>z4 = (-sqy2-pby4, -sqQ2)<br>return (z1, z2,z3, z4)<br>得到一个 4 元组解和循环的左侧和右侧的任何 4 根，看看是否我们得到的除数$s$，应完全$a b c d$。如果我们得到一个然后基本上解决问题。<br>剩下的唯一问题是，我们不知道多少零点的每个$p$， $q$ ，$r$有。让我们试着从 3 零 0 零的所有组合︰<br>p= 0b10001110000110111100100111111000100111<br>q= 0b1110110010101000100001010011110000010100100010111011100111100011010001010101<br>r= 0b1010111100101001100011011101101000000110011010100010001010001100010000111001010011110111011000110010000110010001<br>s= 0b11000010011110000010000010000101010000011101100011101110110110011111000000001011001101111100111001111110001100100101101010011011011101110111001110101<br>A=[]<br>B=[]<br>C=[]<br>D=[s]<br>for i in range(0,3):<br>A.append(p * (2**i))<br>B.append(q * (2</strong>i))<br>C.append(r * (2**i))<br>for i in A:<br>print “====================”<br>for j in B:<br>for k in C:<br>for l in D:<br>(x1, x2, x3, x4) = Carpenter(-i,j,-k,l)</p>
<h1 id="since-sometimes-the-solution-will-consist-of-complex-numbers-we’ll-just-disregard-those-with-a-try-except"><a href="#since-sometimes-the-solution-will-consist-of-complex-numbers-we’ll-just-disregard-those-with-a-try-except" class="headerlink" title="since sometimes the solution will consist of complex numbers, we’ll just disregard those with a try-except"></a>since sometimes the solution will consist of complex numbers, we’ll just disregard those with a try-except</h1><p>try:<br>#approximate value of x1<br>aprox = int(x1.<strong>floor</strong>())<br>for step in range(0,10000):<br>#try to the right<br>if s % (aprox + step) == 0:<br>print aprox + step<br>#and to the left<br>if s % (aprox - step) == 0:<br>print aprox - step<br>except:<br>pass</p>
<p>这样我们得到了所有的四个因素 ！让我们看一下这些实际上将弥补$N$. 而且刚好对应6个密文<br>通常情况下，密文的内容有关于同一密钥作为弹性模量，但在这种情况下他们不。这意味着，要么</p>
<p>指数是小 (说 3) 和消息$m$是真的很短。但然后还有一个主要的问题︰ 因为根本不会被加密明文$m^3$将小于$N$所以$ m^3 $等于$ m^3 \bmod N $(没有加密 = = 坏)<br>指数是一个体面的大小 (通常是 65537) 但模量不是$N$。那么它是什么？提示︰ 密码密钥，大约是一半的模量。<br>由于有 4 质数我们可以作出以下模量︰ $ab $ $ ac $ $ ad $ $ bc $ $ bd $ $ cd$。六模量，六个密码文本 ！</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line">f1 = <span class="number">108082147276398906822234149167480016132157014049560913761488880190018027488520386318253742675423286348552334110023434741671427911613197684395221211646299519273129194692306445874938199068586137486874290442314459278649345469626426790676801658394799404284116771456479272808343825651929906737811050557836671896732124546721747709022607151231423494815945385193624295868730390462068156825588342737037490320356361648437686599733</span></span><br><span class="line">f2 = <span class="number">108082147276398906822234149167480016132157014049560913761488880190018027488520386318253742675423286348552334110023434741671427911613197684395221211646299519273129194692306445874938199068586137486874290442314459278649345469626426790676801658394799404284116771456479272808343825651929906737811050557836671896732124546721747709022607151231423494815945385193624295868730390462068156825588342737037490320356361648437686598461</span></span><br><span class="line">f3 = <span class="number">108082147276398906822234149167480016132157014049560913761488880190018027488520386318253742675423286348552334110023434741671427911613197684395221211646299519273129194692306445874938199068586137486874290442314459278649345469626426790676801658394799404284116771456479272808343825651929906737811050557836671896732124546721747709022607151231423494815945385193624295868730390462068156825588342737037490320356361648437686597791</span></span><br><span class="line">f4 = <span class="number">108082147276398906822234149167480016132157014049560913761488880190018027488520386318253742675423286348552334110023434741671427911613197684395221211646299519273129194692306445874938199068586137486874290442314459278649345469626426790676801658394799404284116771456479272808343825651929906737811050557836671896732124546721747709022607151231423494815945385193624295868730390462068156825588342737037490320356361648437686600843</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">N = <span class="number">136463296143190893248608270448493439350683115492680876168052084053504347848230208722375209906076869052896867483336405778205506777456239889195254751404720423599579856449118314029926341504368322006603240157122006887052352260584975471045726061549619820648607756554188235927302932154082823424745427535138517580059079182622982686168676727690710935334448342460007367100561867135456783067679052102951400317012276135721843672557488711786097028300122487504246207343408690682175135816894247936690735246673985277504237071409859401185555290479154689954442396078547166388871978321863215123445269948324347122830270551854130365741961149443091305418900821360286967705810624380568422193310901491451664233271486835428015602712828527839237760712498204208114606471362410690870710499020885304151928570632315330437235330924071236528549152143092328833484016372976817809299430339752106123272706667690980774118545338761390919046832338928913059106351087015273177895380149217373395580948428521961929052291618261409715145038026920685297885235683434107218249548518659574493203836870070093674704878498465104238178877833471640168999551981025958271865584457582649595664499635489167898398826429084686279399959537724187268210760718340639939389766681703213695409551029265784749153180083564347733676434492122290166926822855552175712346350104533901079605669192289178418165584907326210349152609265563881542151049862642882025360604692084264752182798892702414638180781403398216616666472863758371330058299406233359567750413748257953598843651612399709945608339073191578573877985362619301768016485017815171486743934037935902150228210340093187387036580763941637989511155597643722984057627086517479392172108031663245553269</span></span><br><span class="line"></span><br><span class="line">enc_1 = <span class="number">7106898334865955962704663230185766445951889978440527670379641714370681285859949869949187832359082523864224641583685587358279064795569170851524374568027152395396233789347594775999482749460592054691082921627513982308507181335532299134140407681024881476418889411780375090299905813982101694827597560498543197874412334623795312307111560405270260391658994764065881380399694265015620683173527502434421206862766543229116921174206929733891873772589067987314963792051855633244006474202333168597001157421208180748203884266562430752691702675420434792273754214010918653607624500201387229281379420620532777072560178585294886033718995698223904867539921848198115466603585461755489085844144950962514847839122794545452937035169471880080923607755994138855467643267829059636266176328056201003864357129609343207959211080595752950950566686954867562406898169012</span></span><br><span class="line"></span><br><span class="line">enc_2 = <span class="number">6049049661741129561339303988250162617703359741970199356749378099535308799521119296163475813567458644038456685905251522625056377260310087845057811228022836098917570328692580410899852889868960996513905266043335963520913743708134923879544500911079066640658342641576456724637857109609913138972587873848795314132791317122747052648231297078735128282339170389129703582587817548539040826603188468662975329145727078616857156409325283263490433476018586450960082502578543327451065633585123695731081960986876439520499678158646526292218543279767834119677467758578802705169018711527506297869276113561542222807369071584959189923897216079505316482443445467837921144205079761354928950270172051270453170856002545491432278972735662895438668870901370521394906635478044848448535690635490093836659267778026686404695474454443310769209580317339039949689309577128</span></span><br><span class="line"></span><br><span class="line">enc_3 = <span class="number">9297802808564228678857927735224258610176831223455462482108153962953283311112501933779642540831558523911908205264682548531027493458025348252477502958948277516597689610204247227516319189048436710254675204218913508162139428248916620471317757210444645620644754294112426431692939788347835259617673728076204145049918767636122119264147566892091600628134179775710906591426338082246629946748851355701691716873854064848390273287305765646761438968986164159947841015011854342290060053810459830057357847548324695563067411557873081187572229935066117850179208775004384867270372650455853756560763012162682268812544173997311505136324203900399349629488710197844813293107115270398692552357803651576615589484454781227778727051440858478438251726051391317986762487421941570502251822920317312304622541764818356928105898291743494415190324388360012261032469805293</span></span><br><span class="line"></span><br><span class="line">enc_4 = <span class="number">713095983409993528016630065648951013409887429450761159296479210782308084847050785300379490902448647458053364322993274237841476340954537003347555548992827654062094884577630320399338426853024680425709980978726290825928571411715417634212022523987025390940108095446209802316068849127107378425087055832984628808129531097287891984529260048649164000341136589805930287941174070455962380115617312855801447326371361475429811263285218112383055283949280091896985779211927696867430269968278138068400828124612158603851472016327854927370226178776190765638542240547246882872033038792494915187774790763271179846203704834184269540668646905004118327597860873987248913148268250014480899515845595580486997925049895214602419037682253683176691877538075243485739730794370764108792093424342949560517002862934953109055108423633725444594683266260073663364732952255</span></span><br><span class="line"></span><br><span class="line">enc_5 = <span class="number">10309778311674135836145162475142299890445328570998831868156889990227275287204954712195141311549279047953844775828171871944522109110470024787792366772581241453340259883183812924297131077506375091086889140550405275547002202216935333211274901846970064522877611909017778486075399188006657623263902100044828896866180655435221665929435914366779334701622735670714649165956831390471034827078404866534094264914677879030956272977839491780410171625330771079943455183946885337962048237633491024513227027839179415230496573264968451527246966618074421625677382526573096067979952606553854268016651712174361578916100364115941853700612277618158243626702349480460819792765645689509997114148748479096516230468934427015454217368508102362912163051749856763103972010705773880053579573724226945229453471505368052572019992934401394664840254259798167531746190494146</span></span><br><span class="line"></span><br><span class="line">enc_6 = <span class="number">8939535907261295438433886577386432968291926162277924912979941380189504000322310159787894619015550096747658897136943700072192920334615223423230154197591756541966832740944457435736068401948276698864982347929802551347213730712997519211436818145872722485367264219104124473346589051164722340414948298088909961344463800461486219156960782319672049123860381674970981713865865119998917955886468613202521879160392276542945726096267432761588212550950818569769983241315782390152313705093940640027041352082844550311829177150159737347964813330180325283882516072009654288888676591648012847062527444169352000893928289409020106115561912814987882374652419114381836807085680725260815445689968522849732254659773192714360607196619281714422460754645088867512471482029657153787836396684484646302575186890717770078233479877360251173401000006298555695416782863190</span></span><br><span class="line"></span><br><span class="line">N = f3 * f4</span><br><span class="line">phi = (f3<span class="number">-1</span>)*(f4<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_1, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N = f2 * f4</span><br><span class="line">phi = (f2<span class="number">-1</span>)*(f4<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_2, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N = f1 * f4</span><br><span class="line">phi = (f1<span class="number">-1</span>)*(f4<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_3, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">N = f1 * f3</span><br><span class="line">phi = (f1<span class="number">-1</span>)*(f3<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_4, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N = f1 * f2</span><br><span class="line">phi = (f1<span class="number">-1</span>)*(f2<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_5, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line"></span><br><span class="line">N = f2 * f3</span><br><span class="line">phi = (f2<span class="number">-1</span>)*(f3<span class="number">-1</span>)</span><br><span class="line">d = gmpy2.invert(e, phi)</span><br><span class="line"><span class="keyword">print</span> `hex(pow(enc_6, d, N))`[<span class="number">3</span>:<span class="number">-1</span>].decode(<span class="string">&#x27;hex&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>最终简单的拿到了flag</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>
  </div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>加载评论需要在浏览器启用 JavaScript 脚本支持。</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="https://bestwing.me">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/link">Links</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
         
          <li><a href="/categories/">categories</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#RSA%E2%80%93%E6%B1%82d"><span class="toc-number">1.</span> <span class="toc-text">RSA–求d</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E4%BB%A3%E7%A0%81%E8%A7%A3%E5%86%B3-%E7%AC%A8%E5%8A%9E%E6%B3%95"><span class="toc-number">1.1.</span> <span class="toc-text">自己代码解决  笨办法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python%E6%A8%A1%E5%9D%97%E8%A7%A3%E5%86%B3"><span class="toc-number">1.2.</span> <span class="toc-text">python模块解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%AB%E4%BA%BA%E5%B7%B2%E7%BB%8F%E5%86%99%E5%A5%BD%E7%9A%84%E5%B7%A5%E5%85%B7-%E5%8D%B3rsatool-py"><span class="toc-number">1.3.</span> <span class="toc-text">别人已经写好的工具 即rsatool.py</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%B1%82%E6%98%8E%E6%96%87-N%E5%B7%B2%E7%BB%8F%E8%A2%AB%E5%88%86%E8%A7%A3"><span class="toc-number">2.</span> <span class="toc-text">基础求明文-N已经被分解</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E6%B1%82%E6%98%8E%E6%96%87-N%E6%9C%AA%E8%A2%AB%E5%88%86%E8%A7%A3"><span class="toc-number">3.</span> <span class="toc-text">基础求明文-N未被分解</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#yafu%E9%85%8D%E5%90%88rsatool-py-python"><span class="toc-number">3.1.</span> <span class="toc-text">yafu配合rsatool.py + python</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#512%E4%BD%8D%E7%9A%84%E5%A4%A7%E5%AE%B6%E4%BC%99"><span class="toc-number">4.</span> <span class="toc-text">512位的大家伙</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Python%E8%A7%A3%E5%86%B3"><span class="toc-number">4.1.</span> <span class="toc-text">Python解决</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#openssl%E8%A7%A3%E5%86%B3"><span class="toc-number">4.2.</span> <span class="toc-text">openssl解决</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#hard-RSA"><span class="toc-number">5.</span> <span class="toc-text">hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Very-Hard-RSA"><span class="toc-number">6.</span> <span class="toc-text">Very Hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Extremely-hard-RSA"><span class="toc-number">7.</span> <span class="toc-text">Extremely hard RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Gold-LIke-RSA"><span class="toc-number">8.</span> <span class="toc-text">Gold LIke RSA</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#RSANG"><span class="toc-number">9.</span> <span class="toc-text">RSANG</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#since-sometimes-the-solution-will-consist-of-complex-numbers-we%E2%80%99ll-just-disregard-those-with-a-try-except"><span class="toc-number">10.</span> <span class="toc-text">since sometimes the solution will consist of complex numbers, we’ll just disregard those with a try-except</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=https://bestwing.me/Common-types-of-RSA.html"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=https://bestwing.me/Common-types-of-RSA.html&text=一大波RSA就要来了~~"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=https://bestwing.me/Common-types-of-RSA.html&is_video=false&description=一大波RSA就要来了~~"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=一大波RSA就要来了~~&body=Check out this article: https://bestwing.me/Common-types-of-RSA.html"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=https://bestwing.me/Common-types-of-RSA.html&title=一大波RSA就要来了~~"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=https://bestwing.me/Common-types-of-RSA.html&name=一大波RSA就要来了~~&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://news.ycombinator.com/submitlink?u=https://bestwing.me/Common-types-of-RSA.html&t=一大波RSA就要来了~~"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> 菜单</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> 目录</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> 分享</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> 返回顶部</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2020
    Swing
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="https://bestwing.me">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/link">Links</a></li>
         
          <li><a href="/search/">Search</a></li>
         
          <li><a href="/atom.xml">rss</a></li>
         
          <li><a href="/categories/">categories</a></li>
        
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->

<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">


<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">


    <!-- jquery -->

<script src="/lib/jquery/jquery.min.js"></script>


<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>

<!-- clipboard -->

  
<script src="/lib/clipboard/clipboard.min.js"></script>

  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"复制到粘贴板!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "复制成功!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-133464311-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'swing';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


</body>
</html>
